version: 2
jobs:
  test:
    machine: true
    steps:
      - checkout
      - run: make test-all
  deploy:
    machine: true
    steps:
      - checkout
      - run: make deploy
workflows:
  version: 2
  build_and_test:
    jobs:
      - test

# keep the npm cache around to speed up installs
cache:
  directories:
  - "$HOME/modules/client/.npm"
  - "$HOME/modules/contracts/.npm"
  - "$HOME/modules/database/.npm"
  - "$HOME/modules/hub/.npm"
  - "$HOME/modules/wallet/.npm"
